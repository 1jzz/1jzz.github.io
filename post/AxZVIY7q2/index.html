<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡» | 1jzz</title>
<link rel="shortcut icon" href="https://1jzz.github.io/favicon.ico?v=1659229140591">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://1jzz.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡» | 1jzz - Atom Feed" href="https://1jzz.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="ä»‹ç»
å¾ˆå¤šå“ˆå¸Œç®—æ³•éƒ½å­˜åœ¨Length Extensionæ”»å‡»ï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›å“ˆå¸Œç®—æ³•éƒ½ä½¿ç”¨äº†Merkleâ€“DamgÃ¥rd hash constructionè¿›è¡Œæ•°æ®å‹ç¼©ï¼Œæµè¡Œç®—æ³•æ¯”å¦‚MD5ã€SHA-1ç­‰éƒ½æ”¶åˆ°å½±å“ã€‚
ä»¥MD5ä¸ºä¾‹ï¼Œé¦–å…ˆç®—æ³•å°†æ¶ˆ..." />
    <meta name="keywords" content="å­¦ä¹ " />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://1jzz.github.io">
  <img class="avatar" src="https://1jzz.github.io/images/avatar.png?v=1659229140591" alt="">
  </a>
  <h1 class="site-title">
    1jzz
  </h1>
  <p class="site-description">
    å½“äººç”Ÿè·Œå…¥è°·åº•ï¼Œå‰©ä¸‹çš„æ¯ä¸€æ­¥éƒ½æ˜¯å‘ä¸Šã€‚
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»
            </h2>
            <div class="post-info">
              <span>
                2022-04-11
              </span>
              <span>
                11 min read
              </span>
              
                <a href="https://1jzz.github.io/tag/gT7zd6Cw_/" class="post-tag">
                  # å­¦ä¹ 
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <h1 id="ä»‹ç»">ä»‹ç»</h1>
<p>å¾ˆå¤šå“ˆå¸Œç®—æ³•éƒ½å­˜åœ¨Length Extensionæ”»å‡»ï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›å“ˆå¸Œç®—æ³•éƒ½ä½¿ç”¨äº†Merkleâ€“DamgÃ¥rd hash constructionè¿›è¡Œæ•°æ®å‹ç¼©ï¼Œæµè¡Œç®—æ³•æ¯”å¦‚MD5ã€SHA-1ç­‰éƒ½æ”¶åˆ°å½±å“ã€‚<br>
ä»¥MD5ä¸ºä¾‹ï¼Œé¦–å…ˆç®—æ³•å°†æ¶ˆæ¯ä»¥512bit(å°±æ˜¯64å­—èŠ‚)çš„é•¿åº¦åˆ†ç»„ã€‚æœ€åä¸€ç»„å¿…ç„¶ä¸æ˜¯512bitï¼Œè¿™æ—¶ç®—æ³•å°±ä¼šè‡ªåŠ¨å¾€æœ€åä¸€ç»„ä¸­å¡«å……å­—èŠ‚ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºpaddingã€‚<br>
<img src="https://1jzz.github.io/post-images/1649674820343.png" alt="" loading="lazy"><br>
è€ŒLength Extensionæ˜¯è¿™æ ·çš„ï¼š<br>
å½“çŸ¥é“MD5(secret)å’Œsecretçš„é•¿åº¦æ—¶ï¼Œåœ¨ä¸çŸ¥é“secretçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¨ç®—å‡ºMD5(secret || padding ||m')ã€‚<br>
åœ¨è¿™é‡Œm'æ˜¯è¿½åŠ çš„ä»»æ„æ•°æ®ï¼Œ||æ˜¯è¿æ¥ç¬¦ã€‚paddingæ˜¯secretæœ€åçš„å¡«å……å­—èŠ‚ã€‚<br>
<img src="https://1jzz.github.io/post-images/1649674854051.png" alt="" loading="lazy"></p>
<h1 id="ç†è§£length-extension-attack">ç†è§£Length Extension Attack</h1>
<p>åœ¨ç†è§£Length Extension Attackä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹md5çš„åŠ å¯†æµç¨‹æœ‰ä¸€ä¸ªå¤§è‡´çš„äº†è§£ã€‚è¿™é‡Œä»ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªjavascriptç‰ˆæœ¬çš„md5åŠ å¯†ç®—æ³•ã€‚<br>
é¦–å…ˆï¼ŒMD5ç®—æ³•ä¼šå¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç»„ï¼Œæ¯ç»„64ä¸ªå­—èŠ‚ï¼Œä¸è¶³64ä¸ªå­—èŠ‚çš„éƒ¨åˆ†ç”¨paddingè¡¥é½ã€‚paddingçš„è§„åˆ™æ˜¯ï¼Œåœ¨æœ€æœ«ä¸€ä¸ªå­—èŠ‚ä¹‹åè¡¥å……ä¸€ä¸ª0x80ï¼Œå…¶ä½™éƒ¨åˆ†å¡«å……0x00ï¼Œpaddingæœ€åçš„8ä¸ªå­—èŠ‚ç”¨æ¥è¡¨ç¤ºéœ€è¦å“ˆå¸Œçš„æ¶ˆæ¯é•¿åº¦ã€‚</p>
<pre><code class="language-javascript">function hex_md5(s){ return binl2hex(core_md5(str2binl(s), s.length * chrsz));}

function core_md5(x, len)
{
  /* append padding */
  alert(binl2hex(x));
  x[len &gt;&gt; 5] |= 0x80 &lt;&lt; ((len) % 32);
  x[(((len + 64) &gt;&gt;&gt; 9) &lt;&lt; 4) + 14] = len;
</code></pre>
<p>è¿›è¡Œmd5åŠ å¯†ï¼š<br>
<code>hex_md5(&quot;ljzz&quot;)</code><br>
å› ä¸ºæ•°æ®æ€»å…±åªæœ‰4ä¸ªå­—èŠ‚ï¼Œä¸æ˜¯64ä¸ªå­—èŠ‚ï¼Œå› æ­¤å‰©ä¸‹éƒ¨åˆ†éœ€è¦ç»è¿‡paddingã€‚paddingåçš„æ•°æ®å˜ä¸ºï¼š<br>
<img src="https://1jzz.github.io/post-images/1649674899006.png" alt="" loading="lazy"><br>
æœ€å8ä¸ªå­—èŠ‚ç”¨ä»¥æ•°æ®é•¿åº¦ï¼Œä¸º<code>4*8 = 32</code>ï¼Œåœ¨16è¿›åˆ¶ä¸­å°±æ˜¯20ã€‚<br>
åœ¨å¯¹æ¶ˆæ¯è¿›è¡Œåˆ†ç»„åŠpaddingåï¼ŒMD5ç®—æ³•å¼€å§‹ä¾æ¬¡å¯¹æ¯ç»„æ¶ˆæ¯è¿›è¡Œå‹ç¼©ï¼Œç»è¿‡64è½®æ•°å­¦å˜æ¢ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸€å¼€å§‹ä¼šæœ‰å®šä¹‰å¥½çš„åˆå§‹åŒ–å‘é‡ï¼Œä¸º4ä¸ªä¸­é—´å€¼ï¼Œåˆå§‹åŒ–å‘é‡ä¸æ˜¯éšæœºç”Ÿæˆçš„ï¼Œæ˜¯æ ‡å‡†é‡Œå®šä¹‰æ­»çš„â€”â€”ç¡¬ç¼–ç ï¼š</p>
<pre><code class="language-javascript">  var a =  1732584193;
  var b = -271733879;
  var c = -1732584194;
  var d =  271733878;
  for(var i = 0; i &lt; x.length; i += 16)
  {
    var olda = a;
    var oldb = b;
    var oldc = c;
    var oldd = d;
    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);
    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);
    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);
    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);
    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);
    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);
    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);
    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);
    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);
    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);
    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);
    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);
    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);
    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);
    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);
    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);
    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);
    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);
    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);
    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);
    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);
    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);
    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);
    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);
    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);
    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);
    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);
    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);
    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);
    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);
    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);
    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);
    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);
    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);
    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);
    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);
    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);
    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);
    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);
    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);
    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);
    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);
    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);
    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);
    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);
    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);
    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);
    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);
    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);
    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);
    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);
    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);
    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);
    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);
    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);
    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);
    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);
    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);
    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);
    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);
    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);
    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);
    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);
    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);
    a = safe_add(a, olda);
    b = safe_add(b, oldb);
    c = safe_add(c, oldc);
    d = safe_add(d, oldd);
  }
  return Array(a, b, c, d);
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªforå¾ªç¯ï¼Œåœ¨è¿›è¡Œå®Œæ•°å­¦å˜æ¢åï¼Œå°†æ”¹å˜ä¸´æ—¶ä¸­é—´å€¼ï¼Œè¿™ä¸ªå€¼è¿›å…¥ä¸‹ä¸€è½®forå¾ªç¯ï¼š</p>
<pre><code class="language-javascript">    a = safe_add(a, olda);
    b = safe_add(b, oldb);
    c = safe_add(c, oldc);
    d = safe_add(d, oldd);
</code></pre>
<p>å›å¿†åˆšæ‰çš„MD5ç»“æ„å›¾ï¼Œè¿™ä¸ªforå¾ªç¯çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä¸€æ¬¡æ¬¡çš„å‹ç¼©è¿‡ç¨‹ã€‚ä¸Šä¸€æ¬¡çš„å‹ç¼©ç»“æœï¼Œå°†ä½œä¸ºä¸‹ä¸€æ¬¡å‹ç¼©çš„è¾“å…¥ã€‚è€ŒLength Extensionçš„ç†è®ºåŸºç¡€ï¼Œå°±æ˜¯å°†å·²çŸ¥çš„å‹ç¼©åçš„ç»“æœï¼Œç›´æ¥æ‹¿è¿‡æ¥ä½œä¸ºæ–°çš„å‹ç¼©è¾“å…¥ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦ä¸Šä¸€æ¬¡å‹ç¼©åçš„ç»“æœï¼Œè€Œä¸éœ€è¦çŸ¥é“åŸæ¥çš„æ¶ˆæ¯å†…å®¹æ˜¯ä»€ä¹ˆã€‚</p>
<p>ç„¶åï¼Œç”¨MD5(secret)ä¸­çš„å››ä¸ªä¸­é—´å€¼å’Œpaddingåçš„è¿›è¡Œ64è½®æ•°å­¦å˜æ¢ï¼Œè¿›è¡Œç¬¬äºŒè½®é™„åŠ äº†æ¶ˆæ¯çš„å‹ç¼©ï¼Œäº§ç”Ÿæ–°çš„MD5å€¼ã€‚</p>
<h1 id="md5æ•°æ®å¡«å……æµç¨‹">md5æ•°æ®å¡«å……æµç¨‹</h1>
<ol>
<li>
<p>é‡‡ç”¨å°ç«¯æ¨¡å¼ï¼Œé«˜å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ä¸­ï¼Œè€Œæ•°æ®çš„ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ä¸­</p>
</li>
<li>
<p>padding</p>
<p>ä»¥64å­—èŠ‚ä¸ºä¸€ç»„ï¼Œä¸€å…±512bitï¼Œå…¶ä¸­æœ€å8ä¸ªå­—èŠ‚ç”¨äºå­˜æ”¾éœ€è¦å“ˆå¸Œçš„æ¶ˆæ¯é•¿åº¦:</p>
<p><code>512 - 8*8 =448</code></p>
<p>åˆå› ä¸ºè¦åœ¨æœ€åä¸€ä¸ªå­—èŠ‚ä¸­å¡«å……<code>0x80</code>ï¼Œæ‰€ä»¥éœ€è¦å¡«å……çš„èŒƒå›´ä¸º<code>1bit-448bit</code></p>
</li>
<li>
<p>æ¶ˆæ¯é•¿åº¦</p>
<p>8ä¸ªå­—èŠ‚ï¼Œå³64bitç”¨äºå­˜æ”¾éœ€è¦å“ˆå¸Œçš„æ¶ˆæ¯é•¿åº¦ï¼Œå¦‚æœæ¶ˆæ¯çš„é•¿åº¦å¤§äº2 ^ 64ï¼Œé‚£ä¹ˆ64bitæ— æ³•å­˜å‚¨æ¶ˆæ¯çš„é•¿åº¦ï¼Œåˆ™å–ä½64bitã€‚</p>
</li>
</ol>
<h1 id="å®æ–½length-extension-attack">å®æ–½Length Extension Attack</h1>
<p>ç†è§£äº†Length Extensionçš„åŸç†åï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å®æ–½è¿™ä¸ªæ”»å‡»äº†ã€‚è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼Œé¦–å…ˆæ˜¯MD5å€¼æ€ä¹ˆè¿˜åŸä¸ºå‹ç¼©å‡½æ•°ä¸­æ‰€éœ€è¦çš„4ä¸ªæ•´æ•°ï¼Ÿ<br>
ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯å…ˆæŠŠmd5å€¼æ‹†åˆ†æˆ4ç»„ï¼Œæ¯ç»„8ä¸ªå­—èŠ‚ã€‚æ¯”å¦‚ï¼š<br>
<code>76e7b1efe76ef6fd341392520d6d9318</code><br>
æ‹†åˆ†ä¸ºï¼š<br>
<code>76e7b1ef</code> <code>e76ef6fd</code> <code>34139252</code> <code>0d6d9318</code><br>
ç„¶åå°†è¿™å‡ ä¸ªstringè½¬æ¢ä¸ºæ•´æ•°ï¼Œå†æ ¹æ®ä¸€ç³»åˆ—çš„æ•°å­¦å˜åŒ–ï¼Œè¿˜åŸæˆforå¾ªç¯é‡Œé¢éœ€è¦ç”¨åˆ°aã€bã€cã€dã€‚<br>
æ¥ä¸‹æ¥å°†è¿™4ä¸ªå€¼åŠ å…¥åˆ°MD5çš„å‹ç¼©å‡½æ•°ä¸­ï¼Œå¹¶äº§ç”Ÿæ–°çš„å€¼ã€‚æ­¤æ—¶å°±å¯ä»¥åœ¨åé¢é™„åŠ ä»»æ„æ•°æ®äº†ã€‚<br>
<img src="https://1jzz.github.io/post-images/1649674945614.png" alt="" loading="lazy"><br>
å¦‚æœæƒ³è¦å‘paddingåçš„æ¶ˆæ¯å†è¿½åŠ ä¸€æ¡æ¶ˆæ¯å­—ç¬¦ä¸²&quot;admin&quot;ï¼Œåˆ™ä¼šå¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œpaddingï¼Œå†åˆ©ç”¨ä¸Šä¸€ä¸ªè¿ç®—å‡ºçš„å€¼ä½œä¸ºåˆå§‹å‘é‡è¿›è¡Œå‡½æ•°è¿ç®—ã€‚<br>
<code>6c6a7a7a</code>ï¼Œè¿™å››ä¸ªåå…­è¿›åˆ¶çš„å€¼ä¸ºljzzã€‚<br>
<code>%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%20%00%00%00%00%00%00%00admin</code></p>
<h1 id="æ€è·¯æ•´ç†">æ€è·¯æ•´ç†</h1>
<p>æˆ‘ä»¬åœ¨çŸ¥é“secretçš„é•¿åº¦ä¹‹åå°±å¯ä»¥è‡ªè¡Œå¯¹å…¶è¿›è¡Œpaddingï¼Œç„¶åå†å°†m'ï¼ˆä»»æ„æ•°æ®å¡«å……è¿›å»ï¼‰ï¼Œè¿™æ ·çš„è¯å°±å¯è®¡ç®—å‡º<code>æ¶ˆæ¯+padding+è¿½åŠ ä»»æ„æ•°æ®</code>çš„MD5å€¼ã€‚</p>
<p>åˆ©ç”¨æ¡ä»¶ï¼š</p>
<ul>
<li>çŸ¥é“å¯†æ–‡(secret)çš„å“ˆå¸Œå€¼</li>
<li>çŸ¥é“å¯†æ–‡(secret)çš„é•¿åº¦</li>
</ul>
<h1 id="éªŒè¯">éªŒè¯</h1>
<p>ä½¿ç”¨hashpumpç”ŸæˆMD5å€¼ï¼š</p>
<pre><code class="language-bash">â”Œâ”€â”€(rootğŸ’€kali)-[/home/ljzz/æ¡Œé¢/tools/HashPump]
â””â”€# hashpump                                                                    130 â¨¯
Input Signature: 76e7b1efe76ef6fd341392520d6d9318
Input Data: ljzz
Input Key Length: 4
Input Data to Add: admin
ede46fbde4e6b12b46aee08b45805947
ljzz\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00@\x00\x00\x00\x00\x00\x00\x00admin
</code></pre>
<p>ç”¨äºæµ‹è¯•ä¸¤è€…md5å€¼æ˜¯å¦ç›¸åŒçš„ä»£ç ï¼š</p>
<pre><code class="language-javascript">&lt;?php 

$secret = &quot;ljzz&quot;; 
$password = &quot;%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%20%00%00%00%00%00%00%00admin&quot;;
$hash = &quot;ede46fbde4e6b12b46aee08b45805947&quot;;
if($hash === md5($secret . urldecode($password))){
    echo &quot;success&quot;;
}else{
    die(&quot;failed&quot;);
}
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š<br>
<img src="https://1jzz.github.io/post-images/1649674967231.png" alt="" loading="lazy"></p>
<h1 id="å¦‚ä½•åˆ©ç”¨">å¦‚ä½•åˆ©ç”¨</h1>
<ul>
<li>ä¼ªé€ ç­¾åä¸­çš„å‚æ•°ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„åˆæ³•çš„ç­¾å</li>
<li>é™„åŠ æ–°çš„å‚æ•°(æœªå‡ºç°è¿‡)</li>
<li>lengthå¯ä»¥è€ƒè™‘æš´åŠ›ç ´è§£</li>
</ul>
<h1 id="é˜²å¾¡">é˜²å¾¡</h1>
<ul>
<li>ä½¿ç”¨HMAC-SHA1ä¹‹ç±»çš„HMACç®—æ³•ï¼ˆäº¤æ¢secretå’Œpaddingçš„ä½ç½®ï¼‰</li>
</ul>
<h1 id="å‚è€ƒ">å‚è€ƒ</h1>
<p><a href="http://blog.nsfocus.net/hash-length-extension-attack/">http://blog.nsfocus.net/hash-length-extension-attack/</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E4%BB%8B%E7%BB%8D">ä»‹ç»</a></li>
<li><a href="#%E7%90%86%E8%A7%A3length-extension-attack">ç†è§£Length Extension Attack</a></li>
<li><a href="#md5%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85%E6%B5%81%E7%A8%8B">md5æ•°æ®å¡«å……æµç¨‹</a></li>
<li><a href="#%E5%AE%9E%E6%96%BDlength-extension-attack">å®æ–½Length Extension Attack</a></li>
<li><a href="#%E6%80%9D%E8%B7%AF%E6%95%B4%E7%90%86">æ€è·¯æ•´ç†</a></li>
<li><a href="#%E9%AA%8C%E8%AF%81">éªŒè¯</a></li>
<li><a href="#%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8">å¦‚ä½•åˆ©ç”¨</a></li>
<li><a href="#%E9%98%B2%E5%BE%A1">é˜²å¾¡</a></li>
<li><a href="#%E5%8F%82%E8%80%83">å‚è€ƒ</a></li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://1jzz.github.io/post/t9O1cns6I/">
              <h3 class="post-title">
                æµ…æPadding Oracle Attack
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  å‹é“¾ï¼š <a href="https://www.cnblogs.com/sherlson/" target="_blank">sherlson</a>ã€<a href="https://cyberczy.github.io/" target="_blank">cyberczy</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?d4b50d1451bf48cde435f45724be67b3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  <a class="rss" href="https://1jzz.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
